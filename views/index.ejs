<!DOCTYPE html>
<html lang='es'>
<head>
  <meta charset='UTF-8'>
  <title>Mis Medicamentos</title>
  <link rel='stylesheet' href='/style.css'>
</head>
<body>
  <nav class='navbar'>
    <% if (user) { %>
      <span>Bienvenido, <%= user.username %></span>
      <a href='/'>Inicio</a>
      <a href='/add'>A&ntilde;adir medicamento</a>
      <a href='/logout'>Cerrar sesi&oacute;n</a>
    <% } else { %>
      <a href='/login'>Iniciar sesi&oacute;n</a>
      <a href='/register'>Registrarse</a>
    <% } %>
    <button id='themeToggle'>Cambiar tema</button>
  </nav>
  <div class='container'>
    <h1>Mis Medicamentos</h1>
    <% if (medicines.length === 0) { %>
      <p>No hay medicamentos registrados.</p>
    <% } else { %>
      <table>
        <thead>
          <tr>
            <th>Nombre</th>
            <th>Dosis</th>
            <th>Frecuencia</th>
            <th>Acciones</th>
          </tr>
        </thead>
        <tbody>
          <% medicines.forEach(med => { %>
            <tr>
              <td><%= med.name %></td>
              <td><%= med.dose %></td>
              <td><%= med.frequency %></td>
              <td>
                <a class='btn' href='/edit/<%= med.id %>'>Editar</a>
                <form action='/delete/<%= med.id %>' method='post' style='display:inline'>
                  <button class='btn-danger' type='submit' onclick=\"return confirm('¿Eliminar?')\">Eliminar</button>
                </form>
              </td>
            </tr>
          <% }); %>
        </tbody>
      </table>
    <% } %>
  </div>
  <footer>
    Aplicaci&oacute;n creada por Leandro Maciel. Desarrollada con Node.js, Express y SQLite.<br>
    Contacto: WhatsApp <a href='https://wa.me/543777416857'>+54&nbsp;3777&nbsp;416857</a> | Email <a href='mailto:leandrotvr@gmail.com'>leandrotvr@gmail.com</a>
  </footer>
  <script>
    const current = localStorage.getItem('theme');
    if (current === 'dark') document.body.classList.add('dark');
    document.getElementById('themeToggle').addEventListener('click', function() {
      document.body.classList.toggle('dark');
      if (document.body.classList.contains('dark')) {
        localStorage.setItem('theme', 'dark');
      } else {
        localStorage.setItem('theme', 'light');
      }
    });
  </script>
</body>
</html>
